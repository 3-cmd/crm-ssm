<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="com.cs.crm.workbench.mapper.ActivityMapper" >
  <resultMap id="BaseResultMap" type="com.cs.crm.workbench.domain.Activity" >
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Mon Aug 08 12:44:56 CST 2022.
    -->
    <id column="id" property="id" jdbcType="CHAR" />
    <result column="owner" property="owner" jdbcType="VARCHAR" />
    <result column="type" property="type" jdbcType="VARCHAR" />
    <result column="name" property="name" jdbcType="VARCHAR" />
    <result column="state" property="state" jdbcType="VARCHAR" />
    <result column="startDate" property="startdate" jdbcType="CHAR" />
    <result column="endDate" property="enddate" jdbcType="CHAR" />
    <result column="budgetCost" property="budgetcost" jdbcType="BIGINT" />
    <result column="actualCost" property="actualcost" jdbcType="BIGINT" />
    <result column="description" property="description" jdbcType="VARCHAR" />
    <result column="createBy" property="createby" jdbcType="VARCHAR" />
    <result column="createTime" property="createtime" jdbcType="CHAR" />
    <result column="editBy" property="editby" jdbcType="VARCHAR" />
    <result column="editTime" property="edittime" jdbcType="CHAR" />
  </resultMap>
  <sql id="Base_Column_List" >
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Mon Aug 08 12:44:56 CST 2022.
    -->
    id, owner, type, name, state, startDate, endDate, budgetCost, actualCost, description, 
    createBy, createTime, editBy, editTime
  </sql>
  <select id="selectByPrimaryKey" resultMap="BaseResultMap" parameterType="java.lang.String" >
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Mon Aug 08 12:44:56 CST 2022.
    -->
    select
        a.id,
        a.name,
        u.name owner ,
        a.startDate,
        a.endDate,
        a.budgetCost,
        a.description
    from tbl_marketing_activities a , tbl_user u
    where a.id= #{id} and a.owner=u.id
  </select>

  <select id="selectByPage" resultMap="BaseResultMap" parameterType="com.cs.crm.workbench.domain.Activity">
    select a.id,u1.name owner,a.name,a.startDate,a.endDate,a.budgetcost,a.description,
    a.createTime,u2.name createby,a.editTime,u3.name editby
    from tbl_marketing_activities a
    join tbl_user u1 on a.owner=u1.id
    join tbl_user u2 on a.createBy=u2.id
    left join tbl_user u3 on a.editBy=u3.id
        <where>
            <if test="activityPage.name !=null and activityPage.name !=''">
                a.name like concat("%",#{activityPage.name},"%")
            </if>
            <if test="activityPage.owner !=null and activityPage.owner !=''">
                and u1.name like concat("%",#{activityPage.owner},"%")
            </if>
            <if test="activityPage.startdate !=null and activityPage.startdate != ''">
              and a.startdate &gt;=#{activityPage.startdate}
            </if>
            <if test="activityPage.enddate !=null and activityPage.enddate !=''">
              and a.enddate &lt;= #{activityPage.enddate}
            </if>
        </where>
    order by a.createTime desc
  </select>


  <delete id="deleteByPrimaryKey" parameterType="java.lang.String" >
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Mon Aug 08 12:44:56 CST 2022.
    -->
    delete from tbl_marketing_activities
    where id = #{id,jdbcType=CHAR}
  </delete>


  <insert id="insert" parameterType="com.cs.crm.workbench.domain.Activity" >
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Mon Aug 08 12:44:56 CST 2022.
    -->
    insert into tbl_marketing_activities (id, owner, type, 
      name, state, startDate, 
      endDate, budgetCost, actualCost, 
      description, createBy, createTime, 
      editBy, editTime)
    values (#{id,jdbcType=CHAR}, #{owner,jdbcType=VARCHAR}, #{type,jdbcType=VARCHAR}, 
      #{name,jdbcType=VARCHAR}, #{state,jdbcType=VARCHAR}, #{startdate,jdbcType=CHAR}, 
      #{enddate,jdbcType=CHAR}, #{budgetcost,jdbcType=BIGINT}, #{actualcost,jdbcType=BIGINT}, 
      #{description,jdbcType=VARCHAR}, #{createby,jdbcType=VARCHAR}, #{createtime,jdbcType=CHAR}, 
      #{editby,jdbcType=VARCHAR}, #{edittime,jdbcType=CHAR})
  </insert>
  <insert id="insertSelective" parameterType="com.cs.crm.workbench.domain.Activity" >
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Mon Aug 08 12:44:56 CST 2022.
    -->
    insert into tbl_marketing_activities
    <trim prefix="(" suffix=")" suffixOverrides="," >
      <if test="id != null" >
        id,
      </if>
      <if test="owner != null" >
        owner,
      </if>
      <if test="type != null" >
        type,
      </if>
      <if test="name != null" >
        name,
      </if>
      <if test="state != null" >
        state,
      </if>
      <if test="startdate != null" >
        startDate,
      </if>
      <if test="enddate != null" >
        endDate,
      </if>
      <if test="budgetcost != null" >
        budgetCost,
      </if>
      <if test="actualcost != null" >
        actualCost,
      </if>
      <if test="description != null" >
        description,
      </if>
      <if test="createby != null" >
        createBy,
      </if>
      <if test="createtime != null" >
        createTime,
      </if>
      <if test="editby != null" >
        editBy,
      </if>
      <if test="edittime != null" >
        editTime,
      </if>
    </trim>
    <trim prefix="values (" suffix=")" suffixOverrides="," >
      <if test="id != null" >
        #{id,jdbcType=CHAR},
      </if>
      <if test="owner != null" >
        #{owner,jdbcType=VARCHAR},
      </if>
      <if test="type != null" >
        #{type,jdbcType=VARCHAR},
      </if>
      <if test="name != null" >
        #{name,jdbcType=VARCHAR},
      </if>
      <if test="state != null" >
        #{state,jdbcType=VARCHAR},
      </if>
      <if test="startdate != null" >
        #{startdate,jdbcType=CHAR},
      </if>
      <if test="enddate != null" >
        #{enddate,jdbcType=CHAR},
      </if>
      <if test="budgetcost != null" >
        #{budgetcost,jdbcType=BIGINT},
      </if>
      <if test="actualcost != null" >
        #{actualcost,jdbcType=BIGINT},
      </if>
      <if test="description != null" >
        #{description,jdbcType=VARCHAR},
      </if>
      <if test="createby != null" >
        #{createby,jdbcType=VARCHAR},
      </if>
      <if test="createtime != null" >
        #{createtime,jdbcType=CHAR},
      </if>
      <if test="editby != null" >
        #{editby,jdbcType=VARCHAR},
      </if>
      <if test="edittime != null" >
        #{edittime,jdbcType=CHAR},
      </if>
    </trim>
  </insert>
    <insert id="saveActivitiesByList" parameterType="com.cs.crm.workbench.domain.Activity">
      insert into tbl_marketing_activities(id, owner, name, startDate, endDate, budgetCost, description, createTime, createBy)
        values
        <foreach collection="list" item="obj" separator=",">
          (#{obj.id},#{obj.owner},#{obj.name},#{obj.startdate},#{obj.enddate},#{obj.budgetcost},#{obj.description},#{obj.createtime},#{obj.createby})
        </foreach>
    </insert>
    <update id="updateByPrimaryKeySelective" parameterType="com.cs.crm.workbench.domain.Activity" >
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Mon Aug 08 12:44:56 CST 2022.
    -->
    update tbl_marketing_activities
    <set >
      <if test="owner != null" >
        owner = #{owner,jdbcType=VARCHAR},
      </if>
      <if test="type != null" >
        type = #{type,jdbcType=VARCHAR},
      </if>
      <if test="name != null" >
        name = #{name,jdbcType=VARCHAR},
      </if>
      <if test="state != null" >
        state = #{state,jdbcType=VARCHAR},
      </if>
      <if test="startdate != null" >
        startDate = #{startdate,jdbcType=CHAR},
      </if>
      <if test="enddate != null" >
        endDate = #{enddate,jdbcType=CHAR},
      </if>
      <if test="budgetcost != null" >
        budgetCost = #{budgetcost,jdbcType=BIGINT},
      </if>
      <if test="actualcost != null" >
        actualCost = #{actualcost,jdbcType=BIGINT},
      </if>
      <if test="description != null" >
        description = #{description,jdbcType=VARCHAR},
      </if>
      <if test="createby != null" >
        createBy = #{createby,jdbcType=VARCHAR},
      </if>
      <if test="createtime != null" >
        createTime = #{createtime,jdbcType=CHAR},
      </if>
      <if test="editby != null" >
        editBy = #{editby,jdbcType=VARCHAR},
      </if>
      <if test="edittime != null" >
        editTime = #{edittime,jdbcType=CHAR},
      </if>
    </set>
    where id = #{id,jdbcType=CHAR}
  </update>
  <update id="updateByPrimaryKey" parameterType="com.cs.crm.workbench.domain.Activity" >
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Mon Aug 08 12:44:56 CST 2022.
    -->
    update tbl_marketing_activities
    set owner = #{owner,jdbcType=VARCHAR},
      type = #{type,jdbcType=VARCHAR},
      name = #{name,jdbcType=VARCHAR},
      state = #{state,jdbcType=VARCHAR},
      startDate = #{startdate,jdbcType=CHAR},
      endDate = #{enddate,jdbcType=CHAR},
      budgetCost = #{budgetcost,jdbcType=BIGINT},
      actualCost = #{actualcost,jdbcType=BIGINT},
      description = #{description,jdbcType=VARCHAR},
      editBy = #{editby,jdbcType=VARCHAR},
      editTime = #{edittime,jdbcType=CHAR}
    where id = #{id,jdbcType=CHAR}
  </update>
  <select id="selectAllActivity" resultMap="BaseResultMap">
    select a.id,u1.name owner,a.name,a.startDate,a.endDate,a.budgetcost,a.description,
           a.createTime,u2.name createby,a.editTime,u3.name editby
    from tbl_marketing_activities a
           join tbl_user u1 on a.owner=u1.id
           join tbl_user u2 on a.createBy=u2.id
           left join tbl_user u3 on a.editBy=u3.id
    order by a.createTime desc
  </select>

  <delete id="deleteByActivityIds" parameterType="java.lang.String">
    delete from tbl_marketing_activities where id in
    <foreach collection="ids" item="id" open="(" close=")" separator=",">
      #{id}
    </foreach>
  </delete>

<!--  此处采用子查询,from为根据id查出来的一个表,并且为这个表起别名-->
  <select id="selectActivityByIds" resultMap="BaseResultMap" parameterType="string">
    select  a.id,u1.name owner,a.name,a.startDate,a.endDate,a.budgetcost,a.description,
    a.createTime,u2.name createby,a.editTime,u3.name editby
    from
        (select <include refid="Base_Column_List"></include>
        from tbl_marketing_activities a  where a.id in
            <foreach collection="ids" item="id" open="(" close=")" separator=",">
             #{id}
            </foreach>
        ) a
           join tbl_user u1 on a.owner=u1.id
           join tbl_user u2 on a.createBy=u2.id
           left join tbl_user u3 on a.editBy=u3.id
    order by a.createTime desc
  </select>
</mapper>